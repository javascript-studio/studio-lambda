# Changes

## 4.0.0

- 💥 [`8be1398`](https://github.com/javascript-studio/studio-lambda/commit/8be1398865ee2b415d8fd04436068d495ac586ea)
  Require node 16
- 💥 [`496cc52`](https://github.com/javascript-studio/studio-lambda/commit/496cc525838552e0284f740d07d9c5620233366e)
  Use dynamic import to support loading es modules
- 💥 [`d458059`](https://github.com/javascript-studio/studio-lambda/commit/d4580593c68ef845a236c03a7be02a6bffbb181a)
  Change generic destroy error code to `E_FAILED`
- 🛡 [`8a6a3b3`](https://github.com/javascript-studio/studio-lambda/commit/8a6a3b35a5d28e21502cdbad8140039b8341196f)
  npm audit
- ✨ [`6814ed2`](https://github.com/javascript-studio/studio-lambda/commit/6814ed26f83fdec1807e14b42d2a5c8a12afe973)
  Update Studio Changes
- ✨ [`0d942b9`](https://github.com/javascript-studio/studio-lambda/commit/0d942b9a8733808958dfec9d6f2071901dc8b597)
  Upgrade referee-sinon
- ✨ [`673cc02`](https://github.com/javascript-studio/studio-lambda/commit/673cc0266bdaf961fd8d688d96f0bb6b0221f469)
  Update prettier
- ✨ [`5c264ff`](https://github.com/javascript-studio/studio-lambda/commit/5c264ff5560fc7eb4b518f8f3dfd455f9438d6da)
  Upgrade mocha
- ✨ [`bf9897b`](https://github.com/javascript-studio/studio-lambda/commit/bf9897bc9a2317d3224b0cf4a0abff5e82872c0c)
  Upgrade eslint-config and eslint

_Released by [Maximilian Antoni](https://github.com/mantoni) on 2023-01-19._

## 3.0.2

- 🐛 [`5b7e59e`](https://github.com/javascript-studio/studio-lambda/commit/5b7e59e36d5b041b729ebc41e1b6edf40ad3d390)
  Fix region and account config via env

_Released by [Maximilian Antoni](https://github.com/mantoni) on 2021-06-23._

## 3.0.1

- 🐛 [`e1be0d4`](https://github.com/javascript-studio/studio-lambda/commit/e1be0d43cc69645cd7f9a10b7a51d3358af96b28)
  Handler `JSON.stringify` error in lambda response
- ✨ [`526574b`](https://github.com/javascript-studio/studio-lambda/commit/526574b5dbf616747079a012f5075384b25d92ab)
  Upgrade @sinonjs/referee-sinon to latest (Morgan Roderick)
- ✨ [`2f25018`](https://github.com/javascript-studio/studio-lambda/commit/2f25018dec371373b33c8245549135cb3c79aeb9)
  Set required node version in package-lock.json (Morgan Roderick)

_Released by [Maximilian Antoni](https://github.com/mantoni) on 2021-05-21._

## 3.0.0

- 💥 [`b5a53ad`](https://github.com/javascript-studio/studio-lambda/commit/b5a53ad96c6e915d35015923c5055895c84d7352)
  Require node 12
- 🍏 [`21b2d2c`](https://github.com/javascript-studio/studio-lambda/commit/21b2d2c4b5b6551935335f7df5d2c36e9306add7)
  Return promise in lambda.invoke if no callback is given
- 🍏 [`c37577a`](https://github.com/javascript-studio/studio-lambda/commit/c37577a4beee285f3c6543d30b8b8fa323a0069b)
  Support async lambda functions
- 📚 [`4de3f74`](https://github.com/javascript-studio/studio-lambda/commit/4de3f74669cf682d0bb962e25416b0d4d1611535)
  Document usage with async await
- 🐛 [`2111a8f`](https://github.com/javascript-studio/studio-lambda/commit/2111a8f14f153c703ba2ce8989e56b08c7c4f07d)
  Fix error handling if lambda throws while launching
- ✨ [`957d2e6`](https://github.com/javascript-studio/studio-lambda/commit/957d2e6f7b78fee49db17405cebaf320d049ed71)
  Avoid else by returning early
- ✨ [`e6879f2`](https://github.com/javascript-studio/studio-lambda/commit/e6879f2575c639d9b3feb1915062a73e1c935169)
  Configure GitHub actions
- ✨ [`64de260`](https://github.com/javascript-studio/studio-lambda/commit/64de2605cc4875bd1a66cb067a2f066e6ae8977c)
  Run lint, test and prettier checks separately
- ✨ [`b9db826`](https://github.com/javascript-studio/studio-lambda/commit/b9db8264ebc97c92e21b55489e6015fe90394d6d)
  Update Studio Changes
- ✨ [`0af1d4e`](https://github.com/javascript-studio/studio-lambda/commit/0af1d4e3005cfe863af46b770cfc9d7502738238)
  Upgrade referee-sinon to latest
- ✨ [`f2000dd`](https://github.com/javascript-studio/studio-lambda/commit/f2000dd28b2ca00a987c1404034ad5b687b02ad0)
  Upgrade mocha to latest
- ✨ [`c466a9d`](https://github.com/javascript-studio/studio-lambda/commit/c466a9de0e8954498fe9ef537450db0b891e222e)
  Setup prettier
- ✨ [`e0469bb`](https://github.com/javascript-studio/studio-lambda/commit/e0469bb7d7514d208d67a5de9c1729f71c8cb92b)
  Upgrade eslint and eslint-config
- ✨ [`94c71c6`](https://github.com/javascript-studio/studio-lambda/commit/94c71c6ce1338604b61312731dddc06036317de5)
  Use npm 7
- ✨ [`b121728`](https://github.com/javascript-studio/studio-lambda/commit/b121728669ce120cb737ea750e1a739170ceac70)
  Add .gitignore
- ✨ [`883ba54`](https://github.com/javascript-studio/studio-lambda/commit/883ba544640776b0d24d6adafc1fe449dfe2d56e)
  Fix memory limit tests for node 12
- ✨ [`0914a38`](https://github.com/javascript-studio/studio-lambda/commit/0914a384b6afcfc3c92e977ee3779347cc6e15ab)
  Upgrade referee-sinon to v6
- ✨ [`eb41ede`](https://github.com/javascript-studio/studio-lambda/commit/eb41ede3c2e0abae743d7412c455212b03ccc8b7)
  Upgrade Studio Changes to v2
- ✨ [`570c069`](https://github.com/javascript-studio/studio-lambda/commit/570c069af8cddb1cb65d6ec345b3f17ba9d21384)
  Make eslint-config a dev dependency

_Released by [Maximilian Antoni](https://github.com/mantoni) on 2021-04-21._

## 2.0.2

- 🐛 [`6a70c3c`](https://github.com/javascript-studio/studio-lambda/commit/6a70c3cae4640e68d6dd62196aeac5bfaaf62737)
  Revert "Do not prepend forwarded log namespace with name"

    > This reverts commit 7082da34f64146db43402d40835bfb2ffbb934f7.

## 2.0.1

- 🐛 [`7082da3`](https://github.com/javascript-studio/studio-lambda/commit/7082da34f64146db43402d40835bfb2ffbb934f7)
  Do not prepend forwarded log namespace with name

## 2.0.0

- 💥 [`82e917a`](https://github.com/javascript-studio/studio-lambda/commit/82e917a83d8536e778ffa18aa461c301d5d656e5)
  __BREAKING:__ Upgrade Studio Log to v2
- ✨ [`e0669ea`](https://github.com/javascript-studio/studio-lambda/commit/e0669ea81256c489608fc43c6d8304a5d28293af)
  Use Sinon + Referee and use Sinon default sandbox
- 📚 [`8362816`](https://github.com/javascript-studio/studio-lambda/commit/83628163b14ca0cd937c8ee6ca01fb3b27c36ae0)
  Add commit links with `--commits`

## 1.14.1

- 🐛 Pass error cause in logs through to lambda logger

## 1.14.0

- 🍏 Implement more AWS environment variables for lambda functions
- 🍏 Change log topic for new lambdas from "launch" to "spawn"
- ✨ Add tests for AWS_REGION and AWS_PROFILE environment variables
- ✨ Refactor setting `getRemainingTimeInMillis` on context

## 1.13.0

- 🍏 Add `shutdown` and `stats` APIs
- 🐛 Improve lambda function error handling
- 🐛 Handle ndjson transform errors

## 1.12.0

- 🍏 Use configured memory and improve process exit handling

## 1.11.1

- 🐛 Improve generated `awsRequestId`

## 1.11.0

- 🍏 Add support for `functionName`.
- 🍏 Add support for `awsRequestId`.
- 🍏 Add support for `memoryLimitInMB`.
- 🍏 Add support for `getRemainingTimeInMillis()`.
- 🐛 Build the function ARN within the Lambda function instead of injecting it.
  The `STUDIO_AWS_ACCOUNT` environment variable was not picket up correctly.

## 1.10.1

- ✨ Use `@studio/ndjson` to parse log output from Lambdas

## 1.10.0

- ⚠️ Remove hack to filter log data

    > Log data should be filtered where it's created. With the new
    > `@studio/log-x` module and the updated `@studio/wrap` this hack can be
    > removed.

- ✨ Add `package-lock.json`

## 1.9.1

- 🐛 Add `invokedFunctionArn` to given context if missing

## 1.9.0

- 🍏 Generate `invokedFunctionArn` in default context
- 📚 Use upper case `Lambda` module name in examples

## 1.8.2

- 🐛 Fix entries cleanup in kill handler

    > The entries array is not necessarily cleaned up in reverse insertion
    > order. With this patch, the kill handler does not expect the entry at a
    > fixed position, but queries the entry to remove by ID instead.


## 1.8.1

- 🐛 Fail on missing environment variables

    > - Throw an error if a variable replacement fails.
    > - Handle launch exceptions by logging an error and invoking the callback
    >   with an error message.

## 1.8.0

- 🍏 Support environment variable replacement in Lambda config files

    > If a config file contains placeholders in the form `${ENV_VAR}`, they are
    > replaced with the corresponding environment variable. This feature is not
    > supported by Apex. Use it to configure secret variables in local configs.

## 1.7.0

- 🙊 Do not log Lambda input and output

    > The new `@studio/wrap` implementation already do logging within the
    > Lambda function. Log filtering should also be applied there.

## 1.6.2

- 🐛 Pass on parent process `execArgv`

    > This allows to invoke the parent process with v8 options like
    > `--stack-trace-limit=50` and have them passed on to the Lambda
    > processes. This restores the default behavior for child processes.

## 1.6.1

Log output improvements:

- 🔢 Include the Lambda execution time in the stats log message
- 🙈 Set `config_file` to `"<defaults>"` if not found
- 🙈 Remove messages to streamline log output

## 1.6.0

- 🔢 Log Lambda process memory usage

## 1.5.0

- 🍏 Add Lamdba debugging option

## 1.4.0

- 🍏 Pass on `process.env.DEBUG`

## 1.3.3

- 🍏 Improve log output filtering
- 🍏 Handle Lambda logs on stdout
- 🙈 Do not log `authorizationToken`
- 🐛 Fix log message with string event

## 1.3.2

- 🐛 Reduce duplication in log messages

## 1.3.1

- 🐛 Rename logger

## 1.3.0

- 🍏 Use `@studio/log`

## 1.2.2

- 🐛 Handle invalid lambda response

## 1.2.1

- 🐛 Timeouts are defined in seconds

## 1.2.0

- 🍏 Add `base_dir` config option

## 1.1.2

- 🍏 Pass `HOME` environment variable for the `aws-sdk` module to find the
  credentials file
- ✨ Change log emoji for send and receive events

## 1.1.1

A few bug fixes and minor improvements:

- 🐛 Preserve configured env if config file is loaded
- 🐛 Do not log authorization and token header values
- 🐛 Prefix log messages with "Lambda"
- 🐛 Log lambda error response

## 1.1.0

- 🍏 Allow to pass an optional `context` object to the Lambda handler
  function. If no context is given, it defaults to an empty object, retaining
  the previous behavior.

## 1.0.0

- ✨ Inception
